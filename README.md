# Модель Multi-Client Bank System

[![C++ Standard](https://img.shields.io/badge/C++-17-blue.svg?style=flat-square&logo=c%2B%2B)](https://en.cppreference.com/w/cpp/17)
[![License](https://img.shields.io/badge/License-MIT-green.svg?style=flat-square)](LICENSE)
[![Platform](https://img.shields.io/badge/Platform-Linux%20%7C%20macOS%20%7C%20Windows-lightgrey.svg?style=flat-square)](https://en.wikipedia.org/wiki/POSIX)

В данном репозитории хранятся результаты работы над проектом в рамках спецкурса «Программная инженерия и C++ для количественного анализа и алгоритмической торговли» Фонда "Институт «Вега»".

**Тема проекта**: Создание прототипа безопасной многопользовательской банковской системы с собственной клиент-серверной архитектурой и базой данных.

## Разработчики

**Бойко Руслан** и **Осипов Илья**

## Оглавление

- [Модель Multi-Client Bank System](#модель-multi-client-bank-system)
  - [Разработчики](#разработчики)
  - [Оглавление](#оглавление)
  - [Обзор](#обзор)
  - [Архитектура](#архитектура)
    - [Компонентная диаграмма](#компонентная-диаграмма)
    - [Описание компонентов](#описание-компонентов)
    - [Ключевые компоненты](#ключевые-компоненты)
  - [Функциональность](#функциональность)
    - [Управление пользователями](#управление-пользователями)
    - [Типы счетов](#типы-счетов)
    - [Банковские операции](#банковские-операции)
    - [Система безопасности](#система-безопасности)
  - [Установка и запуск](#установка-и-запуск)
    - [Предварительные требования](#предварительные-требования)
    - [Сборка из исходного кода](#сборка-из-исходного-кода)
    - [Запуск системы](#запуск-системы)
  - [Использование](#использование)
    - [Тестовые учетные записи](#тестовые-учетные-записи)
    - [Основные команды](#основные-команды)
      - [Без авторизации](#без-авторизации)
      - [Клиентские команды](#клиентские-команды)
      - [Команды сотрудника безопасности](#команды-сотрудника-безопасности)
  - [Безопасность](#безопасность)
    - [Меры защиты данных](#меры-защиты-данных)
    - [Модель угроз и защита](#модель-угроз-и-защита)
  - [Разработка](#разработка)
    - [Структура проекта](#структура-проекта)
  - [Тестирование](#тестирование)
  - [Производительность](#производительность)

## Обзор

Secure Bank System — это высоконадёжная банковская система, разработанная на основе стандарта C++17 с использованием многопоточной клиент-серверной архитектуры. Система обеспечивает безопасное хранение данных пользователей, историй операций, систему аутентификации пользователей и многоуровневый контроль операций.

**Ключевые особенности:**

- Сквозное шифрование данных
- Многопользовательский доступ с ролевой моделью
- Многопоточная обработка запросов
- Система одобрения операций в реальном времени
- Защищенное хранение истории транзакций

## Архитектура

### Компонентная диаграмма

![arch_diag](tmp/architecture-diagram.png)

### Описание компонентов

| Слой | Компонента | Назначение |
|------|-----------|------------|
| **Клиентский** | BankClient | Основной клиентский модуль |
| | Пользовательский интерфейс | Обработка команд пользователя |
| | Сетевой клиент | Сетевое взаимодействие с сервером |
| **Серверный** | BankServer | Главный серверный модуль |
| | Менеджер сессий | Управление пользовательскими сессиями |
| | Процессор команд | Обработка и маршрутизация команд |
| | Система одобрения | Управление запросами на одобрение операций |
| **Бизнес-логика** | Менеджер счетов | Операции со счетами и балансами |
| | Транзакционный движок | Обработка финансовых транзакций |
| | Контроллер безопасности | Аутентификация и авторизация |
| **Слой данных** | База данных | Центральное хранилище данных |
| | Модуль шифрования | Шифрование и дешифрование данных |
| | Файловое хранилище | Физическое хранение данных |
| **Внешние** | Сетевой сокет | Сетевая инфраструктура |
| | Файловая система | Системное файловое хранилище |

### Ключевые компоненты

- **BankServer** — многопоточный TCP/IP-сервер с системой управления сессиями
- **BankClient** — консольный клиент с поддержкой интерактивных команд
- **Database** — cлой данных с автоматическим шифрованием/дешифрованием
- **CryptoModule** — модуль безопасности (XOR + Base64, хеширование)
- **AccountSystem** — бизнес-логика счетов и транзакций
- **ApprovalQueue** — cистема одобрения/отклонения операций

## Функциональность

### Управление пользователями

- **Регистрация** с валидацией паспортных данных
- **Двухуровневая аутентификация** (клиенты/сотрудники)
- **Верификация** новых клиентов службой безопасности
- **Управление сессиями** с автоматическим таймаутом

### Типы счетов

- Сберегательный
- Расчетный
- Кредитный
- Депозитный

### Банковские операции

- **Пополнение** и **снятие** средств
- **Переводы между счетами** с проверкой лимитов
- **Автоматическое ведение** истории транзакций
- **Одобрение крупных операций** сотрудниками безопасности

### Система безопасности

- **Шифрование** на основе Base64+XOR всех данных в хранилище
- **Хеширование паролей** по алгоритму SHA-256
- **Очереди одобрения** для операций выше лимита
- **Ролевой доступ** к функциям системы (суперпользователь/пользователь)

## Установка и запуск

### Предварительные требования

- **Компилятор**: GCC 9.0+, Clang 10.0+, или MSVC 2019+
- **Стандарт**: C++17 или выше
- **Память**: 8 ГБ ОЗУ (рекомендуется)
- **Диск**: 128 ГБ (рекомендуется)
- **Сеть**: TCP/IP стек (порт 8080 установлен по умолчанию, но возможен запуск и на другом)

### Сборка из исходного кода

```bash
# Клонирование репозитория
git clone https://github.com/RuzhiyKot/Client-server-app-of-a-banking-system
cd Client-server-app-of-a-banking-system

# Сборка всех компонентов
make all

# Альтернативная сборка отдельных компонентов
make server    # Серверная часть
make client    # Клиентское приложение
make init      # Инициализация базы данных
make view      # Утилита просмотра БД

# Очистка бинарных файлов
make clean
# Очистка базы данных
make clean_data
# Очистка бинарных файлов и базы данных
make distclean
```

### Запуск системы

**Инициализация базы данных**

```bash
# Создание тестовой базы данных (при условии, что она отсутсвует)
make setup

# Просмотр записей в базе данных 
make view_data
```

**Запуск сервера** (терминал 1)

```bash
# Запуск сервера на порту по умолчанию (8080, IP: 127.0.0.1)
make run_server
# Или напрямую:
./bin/bank_server <port>
```

**Запуск клиента** (терминал 2)

```bash
# Запуск клиента на порту по умолчанию (8080, IP: 127.0.0.1)
make run_client
# Или напрямую:
./bin/bank_client 127.0.0.1 <port>
```

## Использование

### Тестовые учетные записи

| Роль | ID пользователя | Пароль | Статус |
|------|-----------------|---------|---------|
| Клиент | `ACC1001` | `password123` | ✅ Верифицирован |
| Клиент | `ACC1002` | `qwerty456` | ✅ Верифицирован |
| Клиент | `ACC1003` | `test789` | ⏳ Ожидает верификации |
| Сотрудник | `SUPER001` | `superpass123` | ✅ Верифицирован |

### Основные команды

#### Без авторизации

```bash
RATES                                  # Просмотр текущих ставок
REGISTER "Kot Kokoc" "2021-01-01" "8800555353" "kotlovefish"  # Регистрация
LOGIN ACC1001 password123              # Вход для клиентов
SUPERLOGIN SUPER001 superpass123       # Вход для сотрудников
HELP                                   # Справка по командам
EXIT                                   # Выход
```

#### Клиентские команды

```bash
ACCOUNTS                   # Список моих счетов
DEPOSIT 1000               # Пополнение на 1000 единиц
WITHDRAW 500               # Снятие 500 единиц
TRANSFER ACC1002 200       # Перевод пользователю ACC1002
HISTORY 0                  # История операций по счету 0
CREATE_ACCOUNT 0           # Создать счёт (0-3: типы счетов)
INFO                       # Информация о клиенте
LOGOUT                     # Выход из системы
EXIT                       # Выход из терминала
```

#### Команды сотрудника безопасности

```bash
PENDING_REQUESTS          # Ожидающие операции
PENDING_VERIFICATIONS     # Клиенты на верификации
APPROVE 0                 # Одобрить запрос 0
REJECT 1                  # Отклонить запрос 1
VERIFY 0                  # Верифицировать клиента 0
SET_RATES 15.0 8.5        # Установить ставки (кредитная, депозитная)
SETTINGS                  # Текущие настройки системы
```

## Безопасность

### Меры защиты данных

- **Шифрование хранилища**: XOR + Base64 с ключом `bank-system-key-2024`
- **Защита паролей**: Хеширование перед хранением
- **Сессионная безопасность**: Таймаут неактивных сессий
- **Валидация операций**: Проверка лимитов и прав доступа

### Модель угроз и защита

| Угроза | Защита |
|--------|---------|
| Неавторизованный доступ | Двухуровневая аутентификация |
| Утечка данных | Сквозное шифрование |
| Мошеннические операции | Система одобрения |
| Отказ в обслуживании | Многопоточная обработка |

## Разработка

### Структура проекта

```text
Client-server-app-of-a-banking-system/
├── CMakeLists.txt
├── Makefile
├── data
│   ├── accounts.dat
│   ├── accounts.dat.settings
│   └── verification_queue.dat
├── src
│   ├── account.cpp
│   ├── account.h
│   ├── client.cpp
│   ├── client.h
│   ├── crypto.cpp
│   ├── crypto.h
│   ├── database.cpp
│   ├── database.h
│   ├── init_database.cpp
│   ├── main_client.cpp
│   ├── main_server.cpp
│   ├── server.cpp
│   ├── server.h
│   └── view_database.cpp
└── tests
    └── test_bank_system.cpp
```

## Тестирование

```bash
# Сборка проекта (Release, или Debug)
cmake -B build -DCMAKE_BUILD_TYPE=Release
cmake --build build --parallel

# Запуск UNIT-тестов
cd build && ctest --output-on-failure && cd ..

# Для удаления сборки
make clean_build
```

## Производительность

**Метрики системы:**

- Время отклика: < 100 мс для стандартных операций
- Поддержка нескольких одновременных подключений (проверяли до 5 подключений)
- Масштабируемость: Модульная архитектура для дальнейшего расширения

*Последнее обновление: декабрь 2025*
